{
  "active": true,
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "MongoDB",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "MongoDB": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "MongoDB",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Function",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2021-12-05T15:52:56.944Z",
  "id": "10",
  "name": "Sign And Hash Block",
  "nodes": [
    {
      "parameters": {},
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        240,
        260
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "signBlock",
        "responseMode": "lastNode",
        "responseData": "allEntries",
        "options": {}
      },
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        240,
        500
      ],
      "webhookId": "2171dcb8-2f1b-496b-ac3f-72d8f27520e3"
    },
    {
      "parameters": {
        "collection": "identities",
        "options": {},
        "query": "{\"name\": \"me\"}"
      },
      "name": "MongoDB",
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1,
      "position": [
        520,
        20
      ],
      "alwaysOutputData": true,
      "credentials": {
        "mongoDb": {
          "id": "1",
          "name": "MongoDB account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "var crypto = require('crypto');\nreturn items.map((item) => {\n  var result = {\n    json: {}\n  };\n  \n  result.json.payload = item.json.payload;\n  result.json.signature = crypto.sign(crypto.RSASSA_PKCS1_SHA256, Buffer.from(JSON.stringify(item.json.payload), 'utf8'), item.json.privateKey).toString('hex');\n  result.json.hash = crypto.createHash('sha512').update(JSON.stringify(item.json.payload) + (item.json.previousHash ? item.json.previousHash : '')).digest(\"hex\");\n  return result;\n});"
      },
      "name": "Function",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1240,
        260
      ]
    },
    {
      "parameters": {
        "mode": "mergeByIndex",
        "join": "inner"
      },
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 1,
      "position": [
        960,
        80
      ]
    }
  ],
  "settings": {},
  "staticData": null,
  "tags": [],
  "updatedAt": "2021-12-05T19:26:40.338Z"
}